package com.pcs.ztqtj.view.activity.main;

import android.content.pm.PackageInfo;
import android.content.pm.PackageManager;

import com.pcs.lib.lib_pcs_v3.model.data.PcsDataManager;
import com.pcs.lib_ztqfj_v2.model.pack.net.PackCheckVersionDown;
import com.pcs.lib_ztqfj_v2.model.pack.net.PackCheckVersionUp;

/**
 * Created by Z on 2017/6/19.
 */

public class ModelMain {
    private ActivityMainNew activity;

    public ModelMain(ActivityMainNew activity) {
        this.activity = activity;
    }

    // 检测版本是否比后台发布的版本低。ture为低
    public boolean checkVersionIsOld() {
        PackCheckVersionDown packcheckversion = (PackCheckVersionDown) PcsDataManager.getInstance().getNetPack(PackCheckVersionUp.NAME);
        if (packcheckversion == null) {
            return false;
        }
        if (packcheckversion.nv == null || "".equals(packcheckversion.nv)) {
            // Toast.makeText(getApplication(), "版本号为空", 0).show();
            return false;
        }

        PackageManager packageManager = activity.getPackageManager();
        // getPackageName()是你当前类的包名，0代表是获取版本信息
        PackageInfo packInfo;
        int version = 0;
        try {
            packInfo = packageManager.getPackageInfo(activity.getPackageName(), 0);
            version = packInfo.versionCode;
        } catch (PackageManager.NameNotFoundException e) {
            e.printStackTrace();
        }
        if (Integer.parseInt(packcheckversion.nv) > version) {
            return true;
        }
        return false;
    }

    public String getVersionIntro() {
        PackCheckVersionDown packcheckversion = (PackCheckVersionDown) PcsDataManager.getInstance().getNetPack(PackCheckVersionUp.NAME);
        String str = "";
        if (packcheckversion == null) {
            str = packcheckversion.des;
        }
        return str;
    }
}
